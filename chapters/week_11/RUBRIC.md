# Week 11 作业评分标准

## 评分总览

| 层级 | 分值范围 | 核心要求 |
|------|---------|---------|
| **基础层** | 0-60 分 | 训练决策树，解读树结构 |
| **进阶层** | 0-30 分 | 训练随机森林，特征重要性分析 |
| **挑战层** | 0-10 分 | 基线对比框架，Bootstrap 置信区间 |
| **总计** | 0-100 分 | 满分 100 分（挑战层为加分项） |

---

## 基础层评分（60 分）

### 任务 1：训练决策树（35 分）

| 评分项 | 分值 | 评分标准 |
|--------|------|---------|
| 正确使用 DecisionTreeClassifier | 8 分 | 4 分：导入和初始化正确<br>4 分：调用 fit() 和 predict() |
| 设置合理的深度限制 | 8 分 | 8 分：设置了 max_depth（或 min_samples_* 等预剪枝参数） |
| 计算完整评估指标 | 10 分 | 4 分：计算了准确率和 AUC<br>3 分：使用了 classification_report<br>3 分：数值正确 |
| 可视化决策树 | 9 分 | 5 分：使用 plot_tree 或 graphviz<br>2 分：包含特征名和类名<br>2 分：图清晰可读 |

**扣分项**：
- 没有限制树深度（导致过拟合）：-5 分
- 只报告准确率，没有 AUC：-3 分
- 没有可视化决策树：-9 分
- 代码无法运行：-10 分

---

### 任务 2：解读决策树（25 分）

| 评分项 | 分值 | 评分标准 |
|--------|------|---------|
| 正确解读根节点分裂规则 | 8 分 | 4 分：指出了分裂特征<br>4 分：指出了阈值 |
| 正确识别最高/最低流失率路径 | 8 分 | 4 分：识别了最高流失率路径<br>4 分：识别了最低流失率路径 |
| 可解释性优势分析合理 | 9 分 | 5 分：给出了优势（如 if-else 规则、业务友好）<br>4 分：与逻辑回归对比 |

**扣分项**：
- 只复制树的可视化，没有文字解读：-10 分
- 误读了分裂规则：-5 分
- 没有与逻辑回归对比：-3 分

---

## 进阶层评分（30 分）

### 任务 3：训练随机森林（15 分）

| 评分项 | 分值 | 评分标准 |
|--------|------|---------|
| 正确使用 RandomForestClassifier | 5 分 | 3 分：参数设置合理（n_estimators, max_depth）<br>2 分：调用 fit() 和 predict() |
| 与决策树对比提升量 | 5 分 | 5 分：计算了 AUC 提升量（绝对或相对） |
| 可解释性差异分析 | 5 分 | 3 分：指出可解释性下降（黑盒 vs 可视化）<br>2 分：解释合理 |

**加分项**：
- 尝试了不同的 n_estimators 并对比：+2 分
- 测量了训练时间：+2 分

---

### 任务 4：特征重要性（15 分）

| 评分项 | 分值 | 评分标准 |
|--------|------|---------|
| 正确提取特征重要性 | 5 分 | 5 分：使用 feature_importances_ 获取 |
| 画出特征重要性条形图 | 5 分 | 3 分：条形图清晰<br>2 分：包含标签和标题 |
| 业务解释合理 | 5 分 | 3 分：解读了最重要的特征<br>2 分：与业务直觉联系 |

**扣分项**：
- 只输出数字，没有画图：-3 分
- 没有业务解释：-3 分

---

## 挑战层评分（10 分 + 加分）

### 任务 5：基线对比框架（10 分）

| 评分项 | 分值 | 评分标准 |
|--------|------|---------|
| 训练多个基线模型 | 3 分 | 1 分：傻瓜基线<br>1 分：逻辑回归<br>1 分：决策树 |
| 制作完整对比表 | 3 分 | 2 分：包含 AUC 和训练时间<br>1 分：格式清晰 |
| 明确的模型选择理由 | 4 分 | 2 分：考虑了提升量<br>1 分：考虑了复杂度<br>1 分：考虑了可解释性 |

**加分项**：
- 测量了预测时间（不只是训练时间）：+2 分
- 用交叉验证评估稳定性：+3 分

---

### 任务 6（加分）：Bootstrap 置信区间（额外 5-10 分）

| 评分项 | 分值 | 评分标准 |
|--------|------|---------|
| 正确实现 Bootstrap | 4 分 | 2 分：有放回抽样<br>2 分：重复足够次数（>=1000） |
| 计算置信区间 | 3 分 | 3 分：正确计算 95% CI |
| 判断提升量显著性 | 3 分 | 3 分：基于置信区间重叠判断 |

---

## AI 协作练习（可选，额外 2-5 分）

| 评分项 | 分值 | 评分标准 |
|--------|------|---------|
| 审查清单完成 | 2 分 | 2 分：勾选了 AI 代码中的问题 |
| 修订版质量 | 3 分 | 3 分：修订版准确、完整，修正了识别出的问题 |

---

## 评分维度说明

### 1. 代码正确性（35%）
- 代码可以运行，无语法错误
- 使用正确的 API 和参数
- 输出结果正确

### 2. 概念理解（30%）
- 理解决策树的工作原理（根节点、分裂规则、叶节点）
- 理解随机森林的原理（Bagging、特征随机性）
- 理解基线对比的重要性

### 3. 分析与表达（25%）
- 正确解读决策树结构
- 分析可解释性差异
- 给出合理的模型选择理由

### 4. 工程实践（10%）
- 防止过拟合（限制树深度）
- 使用 Pipeline 防止数据泄漏
- 代码结构清晰、可读性好

---

## 常见错误与扣分标准

| 错误类型 | 扣分 | 说明 |
|---------|------|------|
| 决策树不限制深度 | -5 到 -10 分 | 导致严重过拟合 |
| 只看 AUC 绝对值 | -3 分 | 没有与基线对比 |
| 混淆 Bagging 和随机森林 | -3 分 | 随机森林 = Bagging + 特征随机性 |
| 误认为特征重要性是 p 值 | -2 分 | 特征重要性不反映统计显著性 |
| 没有考虑可解释性 | -2 到 -5 分 | 模型选择不只看 AUC |
| 代码无法运行 | -10 分 | 需要确保代码可运行或注明是伪代码 |
| 只给代码没有分析 | -20% | 分析和代码同等重要 |

---

## 优秀作业示例特征

一份优秀的作业应该：

1. **代码部分**：
   - 代码结构清晰，有适当注释
   - 使用了预剪枝防止过拟合
   - 输出结果格式化，易于阅读
   - 包含决策树可视化图

2. **分析部分**：
   - 正确解读了决策树的决策规则
   - 分析了可解释性差异（决策树 vs 随机森林）
   - 与基线对比，给出了明确的模型选择理由
   - 用自己的话解释（不是复制粘贴）

3. **工程实践**：
   - 防止过拟合（限制树深度）
   - 与多个基线对比
   - 考虑了训练时间、可解释性、预测力
   - 代码可复现（设置 random_state）

4. **报告格式**：
   - Markdown 格式清晰
   - 表格和图表标注完整
   - 结论有数据支撑

---

## 反馈建议模板

在给作业反馈时，可以使用以下模板：

```
【优点】
- （具体表扬，如：正确解读了决策树结构，基线对比完整）

【待改进】
- （具体问题，如：没有限制决策树深度，导致过拟合）
- （具体建议，如：建议在可视化图中标注特征名）

【总分】X/100
```

---

## 测试与验证

作业中的关键检查点应该能被 `tests/` 目录中的测试覆盖：

- `test_decision_tree()`：验证决策树训练
- `test_random_forest()`：验证随机森林训练
- `test_feature_importance()`：验证特征重要性提取
- `test_baseline_comparison()`：验证基线对比
- `test_bootstrap_auc()`：验证 Bootstrap 置信区间

评分时可以运行这些测试来验证代码正确性。

---

## 最后提醒

评分的目的是帮助学生学习，而不仅仅是打分。在评分时：
1. 指出具体的错误和改进方向
2. 鼓励学生用自己的话解释概念
3. 认可学生的努力和进步

记住 Week 11 的核心目标：**理解树模型的工作原理，学会与基线对比，权衡提升量、复杂度与可解释性。**
