# Week 14 评分标准

## 评分维度

| 维度 | 分值 | 说明 |
|------|------|------|
| **代码质量** | 30 分 | 可运行、结构清晰、注释充分、固定随机种子 |
| **统计理解** | 30 分 | 概念准确、解释清晰、不混淆频率学派与贝叶斯学派 |
| **可复现性** | 20 分 | 随机种子固定、依赖明确、结果可重现 |
| **报告质量** | 20 分 | 结构清晰、决策建议合理、结论边界明确 |

**总分**：100 分（基础作业 85 分 + 进阶作业 15 分）

---

## 具体评分细则

### 习题 1：频率学派 vs 贝叶斯学派（10 分）

| 评分项 | 分值 | 评分标准 |
|--------|------|----------|
| **两种范式差异** | 5 分 | ✅ 准确区分频率学派（重复抽样）和贝叶斯学派（信念更新）<br>✅ 正确解释 p 值（不是 P(H0\|data)）<br>✅ 说明决策友好性差异（二元 vs 连续概率）<br>⚠️ 部分混淆：2-3 分<br>❌ 完全混淆：0 分 |
| **置信区间 vs 可信区间** | 5 分 | ✅ 准确解释置信区间（"方法可靠性"，不是"参数概率"）<br>✅ 准确解释可信区间（"参数在区间内的概率"）<br>✅ 用具体例子说明决策差异<br>⚠️ 解释不准确：2-3 分<br>❌ 混淆两种区间：0 分 |

**常见错误与扣分**：
- ❌ 把置信区间解释为"参数有 95% 的概率在区间内"：-3 分
- ❌ 说"贝叶斯更好"但没有说明场景：-2 分
- ❌ 混淆 p 值和 P(H0\|data)：-3 分

---

### 习题 2：先验设定与敏感性（15 分）

| 评分项 | 分值 | 评分标准 |
|--------|------|----------|
| **先验设定** | 5 分 | ✅ 三种先验参数合理<br>✅ 强信息先验基于历史数据（均值 0.052，标准差 0.01）<br>⚠️ 参数不合理：2-3 分<br>❌ 先验错误：0 分 |
| **后验计算** | 5 分 | ✅ Beta-Binomial 共轭先验正确<br>✅ 后验均值和 95% CI 计算正确<br>⚠️ 计算错误：2-4 分<br>❌ 完全错误：0 分 |
| **敏感性分析** | 5 分 | ✅ 对比三种先验，判断稳健性<br>✅ 结论与结果一致（差异大 = 敏感，差异小 = 稳健）<br>⚠️ 只列数字无判断：2-3 分<br>❌ 结论与结果矛盾：0 分 |

**常见错误与扣分**：
- ❌ 先验参数不合理（强信息先验标准差比数据还大）：-3 分
- ❌ 后验计算错误（忘记加 successes 和 failures）：-3 分
- ❌ 用"数据依赖的先验"（先看数据再设先验）：-5 分（作弊）

---

### 习题 3：贝叶斯 A/B 测试（20 分）

| 评分项 | 分值 | 评分标准 |
|--------|------|----------|
| **PyMC 模型定义** | 10 分 | ✅ 先验、似然、MCMC 定义正确<br>✅ 感兴趣量（delta、rel_uplift）定义合理<br>✅ 采样设置合理（chains>=2, tune, 采样量）<br>⚠️ 部分错误：5-8 分<br>❌ 模型无法运行：0 分 |
| **关键指标计算** | 5 分 | ✅ P(B > A) 计算正确<br>✅ 后验摘要（均值、95% HDI）正确<br>✅ 使用 `az.summary` 打印摘要<br>⚠️ 计算错误：2-4 分<br>❌ 完全错误：0 分 |
| **决策建议** | 5 分 | ✅ 建议与结果一致（P(B > A) = 72% → 倾向 B 但需更多数据）<br>✅ 参考决策边界（90% 上线，60% 放弃，中间继续）<br>✅ 语言简洁，产品经理能懂<br>⚠️ 建议与结果矛盾：2-3 分<br>❌ 无建议或建议错误：0 分 |

**常见错误与扣分**：
- ❌ 没有固定随机种子：-2 分
- ❌ R-hat > 1.05 还在用结果：-5 分（结果不可信）
- ❌ 决策建议与结果矛盾（P=72% 却说"放弃 B"）：-3 分
- ❌ 只输出数字，没有决策建议：-3 分

---

### 习题 4：MCMC 采样与诊断（20 分）

| 评分项 | 分值 | 评分标准 |
|--------|------|----------|
| **贝叶斯回归实现** | 10 分 | ✅ PyMC 模型定义正确（先验、似然）<br>✅ MCMC 设置合理（chains=4, tune=2000, 采样量=3000）<br>✅ 固定随机种子<br>⚠️ 部分错误：5-8 分<br>❌ 模型无法运行：0 分 |
| **收敛诊断** | 5 分 | ✅ trace plot 检查（链混合良好、平稳）<br>✅ R-hat < 1.01（或至少 < 1.05）<br>✅ ESS > 400<br>⚠️ 只检查 1-2 项：2-4 分<br>❌ 没有诊断：0 分 |
| **诊断解释** | 5 分 | ✅ 正确解释 trace plot（"像毛毛虫" = 收敛）<br>✅ 正确解释 R-hat（< 1.01 = 链间一致）<br>✅ 正确解释 ESS（有效样本量，> 400 = 充分）<br>✅ 诊断失败时有改进措施<br>⚠️ 解释不准确：2-4 分<br>❌ 没有解释：0 分 |

**常见错误与扣分**：
- ❌ 没有固定随机种子：-2 分
- ❌ 只看结果，不检查收敛：-5 分（结果不可信）
- ❌ R-hat > 1.05 还在用结果：-5 分
- ❌ 把 ESS 理解为"采样次数"：-2 分

---

### 习题 5：StatLab 贝叶斯升级（20 分）

| 评分项 | 分值 | 评分标准 |
|--------|------|----------|
| **贝叶斯模型实现** | 10 分 | ✅ PyMC 模型定义正确（因果推断框架）<br>✅ 包含处理变量和混杂变量<br>✅ MCMC 采样成功<br>⚠️ 部分错误：5-8 分<br>❌ 模型无法运行：0 分 |
| **先验敏感性分析** | 5 分 | ✅ 至少测试三种先验<br>✅ 对比后验均值和 95% HDI<br>✅ 判断稳健性（差异大 = 敏感）<br>⚠️ 只测试 1-2 种先验：2-3 分<br>❌ 没有敏感性分析：0 分 |
| **贝叶斯章节报告** | 5 分 | ✅ 结构清晰（研究问题 → 后验摘要 → 对比 → 边界）<br>✅ 解释准确（可信区间 vs 置信区间）<br>✅ 对比频率学派结果<br>✅ 结论边界明确（不夸大能力）<br>⚠️ 结构混乱：2-4 分<br>❌ 缺少关键部分：0 分 |

**常见错误与扣分**：
- ❌ 没有先验敏感性分析：-5 分
- ❌ 报告只列数字，没有解释：-3 分
- ❌ 混淆置信区间和可信区间：-3 分
- ❌ 没有写清结论边界：-2 分

---

### 习题 6：层次模型（10 分，选做）

| 评分项 | 分值 | 评分标准 |
|--------|------|----------|
| **层次模型实现** | 7 分 | ✅ PyMC 层次模型定义正确（超先验、先验、似然）<br>✅ shape 参数正确（`shape=n_countries`）<br>✅ MCMC 采样成功<br>⚠️ 部分错误：3-5 分<br>❌ 模型无法运行：0 分 |
| **对比与解释** | 3 分 | ✅ 对比非层次模型（单独分析）<br>✅ 说明 shrinkage 效应（小样本 CI 变窄）<br>✅ 解释信息共享机制<br>⚠️ 只列数字无解释：1-2 分<br>❌ 没有对比：0 分 |

**常见错误与扣分**：
- ❌ 层次模型定义错误（忘记 shape 参数）：-3 分
- ❌ 没有对比非层次模型：-2 分
- ❌ 只看数字，没有解释 shrinkage：-2 分

---

### 习题 7：贝叶斯回归阅读心得（5 分，选做）

| 评分项 | 分值 | 评分标准 |
|--------|------|----------|
| **核心区别** | 2 分 | ✅ 准确理解贝叶斯回归和 OLS 的区别<br>✅ 后验分布 vs 点估计<br>⚠️ 理解不准确：1 分 |
| **正则化说法** | 1 分 | ✅ 正确评价"贝叶斯回归就是加正则化的回归"<br>✅ 数学上等价，解释不同<br>❌ 否认或完全同意：0 分 |
| **优势场景** | 2 分 | ✅ 场景合理（小样本、先验知识、不确定性量化）<br>✅ 有具体理由<br>⚠️ 场景不合理或无理由：1 分 |

**常见错误与扣分**：
- ❌ 说"贝叶斯回归更准确"（没有场景）：-2 分
- ❌ 否认"正则化"说法：-1 分（数学上确实等价）
- ❌ 列优势但不解释原因：-1 分

---

## AI 协作练习评分（可选，5 分）

| 评分项 | 分值 | 评分标准 |
|--------|------|----------|
| **问题识别** | 3 分 | ✅ 发现至少 3 个问题（先验、采样、诊断）<br>⚠️ 发现 2 个问题：2 分<br>⚠️ 发现 1 个问题：1 分 |
| **修复正确** | 2 分 | ✅ 修复后的代码可运行<br>✅ 修复合理（不是"改了就行"）<br>⚠️ 修复部分问题：1 分 |

**AI 代码中的常见问题**：
1. 先验太强（Beta(1, 100) 假设转化率 1%，与观测 5.8% 矛盾）
2. 采样设置不合理（只有 1 条链、没有 tune、采样量 1000）
3. 没有收敛诊断（R-hat、ESS、trace plot）

---

## 总分换算

### 基础作业（必做）

| 习题 | 分值 |
|------|------|
| 习题 1 | 10 分 |
| 习题 2 | 15 分 |
| 习题 3 | 20 分 |
| 习题 4 | 20 分 |
| 习题 5 | 20 分 |
| **小计** | **85 分** |

### 进阶作业（选做）

| 习题 | 分值 |
|------|------|
| 习题 6 | 10 分 |
| 习题 7 | 5 分 |
| **小计** | **15 分** |

### AI 协作练习（可选）

| 练习 | 分值 |
|------|------|
| AI 审查报告 | 5 分（额外加分） |

### 最终得分

- **基础作业得分** / 85 × 100 = 基础分（百分制）
- **进阶作业加分**：最多 +15 分
- **AI 练习额外加分**：最多 +5 分

**示例**：
- 基础作业得 75 分：75/85 × 100 = 88.2 分
- 进阶作业得 10 分：88.2 + 10 = 98.2 分
- AI 练习得 3 分：98.2 + 3 = 101.2 分（满分 100）

---

## 评分维度详解

### 1. 代码质量（30 分）

| 评分项 | 分值 | 评分标准 |
|--------|------|----------|
| **可运行性** | 10 分 | ✅ 所有代码可运行（无报错）<br>✅ 输出符合要求<br>⚠️ 部分报错：5-8 分<br>❌ 完全无法运行：0 分 |
| **结构清晰** | 10 分 | ✅ 函数封装合理（不是一坨代码）<br>✅ 变量命名清晰<br>✅ 有必要的注释<br>⚠️ 结构混乱：5-8 分<br>❌ 完全没有结构：0 分 |
| **随机种子** | 10 分 | ✅ 所有随机操作固定种子<br>✅ 结果可复现<br>⚠️ 部分固定：5-8 分<br>❌ 没有固定：0 分 |

**常见扣分项**：
- 代码无法运行（-10 分）
- 没有固定随机种子（-5 分）
- 变量命名混乱（-3 分）
- 缺少注释（-2 分）

---

### 2. 统计理解（30 分）

| 评分项 | 分值 | 评分标准 |
|--------|------|----------|
| **概念准确** | 15 分 | ✅ 不混淆频率学派与贝叶斯学派<br>✅ 不混淆置信区间与可信区间<br>✅ 不混淆 p 值和 P(H0\|data)<br>⚠️ 部分混淆：5-10 分<br>❌ 严重混淆：0 分 |
| **解释清晰** | 15 分 | ✅ 用自己的话解释（不是背定义）<br>✅ 解释有具体场景支撑<br>✅ 决策建议合理<br>⚠️ 解释模糊：5-10 分<br>❌ 没有解释：0 分 |

**常见扣分项**：
- 混淆置信区间和可信区间（-5 分）
- 说"贝叶斯更好"但没有场景（-3 分）
- 解释完全是教科书定义（-3 分）
- 决策建议与结果矛盾（-5 分）

---

### 3. 可复现性（20 分）

| 评分项 | 分值 | 评分标准 |
|--------|------|----------|
| **随机种子** | 10 分 | ✅ 所有代码固定种子<br>✅ 多次运行结果一致<br>⚠️ 部分固定：5-8 分<br>❌ 没有固定：0 分 |
| **依赖明确** | 5 分 | ✅ 列出所有依赖包及版本<br>✅ 运行环境说明清晰<br>⚠️ 部分缺失：2-3 分<br>❌ 没有说明：0 分 |
| **结果可复现** | 5 分 | ✅ 新机器上可运行<br>✅ 结果与报告一致<br>⚠️ 部分复现：2-3 分<br>❌ 无法复现：0 分 |

**常见扣分项**：
- 没有固定随机种子（-10 分）
- 没有说明依赖包（-5 分）
- 代码有硬编码路径（-3 分）

---

### 4. 报告质量（20 分）

| 评分项 | 分值 | 评分标准 |
|--------|------|----------|
| **结构清晰** | 8 分 | ✅ 有明确章节（习题 1-7）<br>✅ 每个习题有"问题 → 方法 → 结果 → 结论"<br>⚠️ 结构混乱：3-5 分<br>❌ 没有结构：0 分 |
| **决策建议** | 8 分 | ✅ 有明确的决策建议（不是"显著/不显著"）<br>✅ 建议与结果一致<br>✅ 语言简洁，决策者能懂<br>⚠️ 建议模糊：3-5 分<br>❌ 没有建议：0 分 |
| **结论边界** | 4 分 | ✅ 明确说明"能回答什么"<br>✅ 明确说明"不能回答什么"<br>✅ 不夸大统计方法的能力<br>⚠️ 边界模糊：1-2 分<br>❌ 没有边界：0 分 |

**常见扣分项**：
- 报告只列数字，没有解释（-5 分）
- 决策建议与结果矛盾（-5 分）
- 没有写清结论边界（-3 分）
- 语言过于学术，决策者看不懂（-3 分）

---

## 特殊扣分项

### 严重错误（直接扣 10-20 分）

- ❌ **数据依赖的先验**：先看数据再设先验（作弊，-10 分）
- ❌ **忽略收敛诊断**：R-hat > 1.05 还在用结果（-10 分）
- ❌ **混淆概念**：说"95% 置信区间意味着参数有 95% 的概率在区间内"（-10 分）
- ❌ **代码完全无法运行**：没有测试就提交（-10 分）

### 中等错误（扣 3-5 分）

- ⚠️ 没有固定随机种子（-5 分）
- ⚠️ 只输出数字，没有决策建议（-5 分）
- ⚠️ 没有先验敏感性分析（-5 分）
- ⚠️ 决策建议与结果矛盾（-3 分）
- ⚠️ 混淆置信区间和可信区间（-3 分）

### 轻微错误（扣 1-2 分）

- ⚠️ 变量命名混乱（-2 分）
- ⚠️ 缺少注释（-2 分）
- ⚠️ 报告格式混乱（-2 分）
- ⚠️ 没有说明依赖包（-2 分）

---

## 优秀标准（获得 90+ 分的参考）

### 代码质量
- 所有代码可运行，函数封装合理，变量命名清晰
- 所有随机操作固定种子，结果 100% 可复现
- 有必要的注释，解释关键步骤

### 统计理解
- 完全不混淆频率学派与贝叶斯学派的概念
- 准确解释置信区间 vs 可信区间
- 决策建议与结果完全一致，语言简洁

### 可复现性
- 固定所有随机种子
- 说明所有依赖包及版本
- 代码在新机器上可直接运行

### 报告质量
- 结构清晰（问题 → 方法 → 结果 → 结论）
- 有明确的决策建议（不是"显著/不显著"）
- 明确说明结论边界（能回答什么、不能回答什么）
- 语言简洁，决策者能看懂

### StatLab 升级
- 在 StatLab 报告中成功添加贝叶斯章节
- 对比频率学派与贝叶斯学派的结果
- 说明贝叶斯方法的优势（决策友好性）
- 明确结论边界（不夸大能力）

---

## 最后提醒

### 对评分者
1. **先看代码能否运行**：如果无法运行，直接扣 10 分，不再检查后续
2. **固定随机种子是硬要求**：没有固定种子的代码扣 5 分
3. **收敛诊断是硬要求**：R-hat > 1.05 的结果扣 10 分
4. **概念准确性优先**：混淆置信区间和可信区间扣 5-10 分
5. **决策建议是加分项**：有明确决策建议的加 3-5 分

### 对学生
1. **不要直接复制参考代码**：理解后自己写，否则容易被识别为抄袭
2. **固定随机种子**：这是可复现性的基础
3. **检查收敛**：R-hat < 1.01 且 ESS > 400
4. **写清决策建议**：不要只列数字
5. **说明结论边界**：不夸大统计方法的能力

祝学习顺利！贝叶斯思维是从"统计计算"到"决策思维"的关键跃迁，本周作业会帮你完成这个跃迁。
