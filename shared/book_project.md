# 贯穿项目：数据因果探索者报告

## 项目设计理念（基于 Judea Pearl 的因果思维）

传统数据分析项目往往停留在"发现相关性"，但本课程强调"探索因果关系"。

**Judea Pearl 的启示**：
> "数据本身不说话，因果推断让数据说话。没有因果思维，AI 只是高级的模式匹配。"

### 项目核心问题

不只是一般性的"探索数据"，而是回答：
1. **描述**：数据中有什么模式？
2. **推断**：这些模式在总体中成立吗？
3. **预测**：能预测未来的结果吗？
4. **因果**：**X 真的导致 Y 吗？**（本项目的重点）

---

## 项目阶段（16周对应）

### 阶段 1：选题与数据获取（Week 01-02）

**任务**：
- 选择感兴趣的数据集
- 初步数据探索
- **明确研究问题**（必须包含因果问题，如"什么因素导致了..."）

**可选数据集来源**：

| 类型 | 示例 | 适合的分析 |
|------|------|-----------|
| 公共竞赛 | Kaggle Titanic、House Prices | 预测 + 因果探索 |
| 政府开放数据 | 国家统计局、WHO COVID-19 | 趋势 + 因果推断 |
| UCI ML | Adult Income、German Credit | 分类 + 公平性 |
| 自建数据 | 问卷、实验 | 强因果设计 |

**检查点**：
- [ ] 数据集已获取并可加载
- [ ] 有明确的研究问题（**包含因果问题**）
- [ ] 初步 EDA 报告
- [ ] **画初始因果图**（Week 02 开始尝试）

---

### 阶段 2：数据清洗与 EDA（Week 03-04）

**任务**：
- 处理缺失值、异常值
- 数据类型转换
- 生成描述性统计
- 创建探索性可视化

**特别强调（吴恩达 Data-centric AI）**：
- 记录每一个清洗决策
- 考虑缺失机制（MCAR/MAR/MNAR）
- 异常值：错误还是信号？

**交付物**：
- `data_cleaning.ipynb`：清洗过程和决策记录
- `eda_report.ipynb`：探索性分析
  - 变量分布
  - 相关性分析（**但强调：相关≠因果**）
  - 有趣的初步发现（3-5 个）
- **因果图 v1.0**：初步的变量关系假设

---

### 阶段 3：统计推断（Week 05-08）

**任务**：
- 根据研究问题设计假设检验
- 选择合适检验方法
- 计算 p-value、置信区间、效应量
- **Bootstrap 验证**

**特别强调（Gelman）**：
- 检验前提验证（残差分析）
- 效应量 > p-value
- 置信区间解释

**交付物**：
- `statistical_analysis.ipynb`：
  - 研究假设（H0, H1）
  - 检验方法选择理由
  - **前提条件验证**（Gelman 的模型检查）
  - 结果和解释（p-value + 效应量 + 置信区间）
- **因果图 v2.0**：基于检验结果修正

---

### 阶段 4：预测建模（Week 09-12）

**任务**：
- 建立预测模型（回归或分类）
- 特征工程
- 模型评估和选择
- **模型解释（SHAP 等）**

**特别强调**：
- 训练/测试分割的重要性
- 过拟合检查（Gelman）
- **可解释性优先**（不是黑盒模型）

**交付物**：
- `predictive_model.ipynb`：
  - 模型选择理由
  - 特征工程过程
  - 性能评估（多指标）
  - **特征重要性分析**（哪些因素影响结果？）
  - **模型局限性讨论**

---

### 阶段 5：因果推断尝试（Week 13-15）⭐ 重点项目特色

**任务**：
- 画因果图（Judea Pearl 的方法）
- 识别混杂变量
- 尝试因果推断方法

**方法选择**（根据数据情况）：
- 有随机实验数据：直接分析
- 有工具变量：IV 方法
- 有面板数据：双重差分
- 只有观察数据：匹配、加权、或敏感性分析

**特别强调（Pearl）**：
- **没有因果假设，就没有因果结论**
- 因果图明确假设
- 讨论局限性

**交付物**：
- `causal_analysis.ipynb`（或章节）：
  - **因果图**（DAG）
  - 混杂变量识别
  - 因果推断方法
  - 结果解释
  - **局限性讨论**（观察数据的局限）

---

### 阶段 6：整合与展示（Week 16）

**任务**：
- 整合分析为连贯的故事
- 创建最终可视化
- 准备展示材料

**故事线建议**：
1. **问题**：我们想知道什么？（特别是因果问题）
2. **数据**：我们有什么数据？
3. **发现**：数据中看到了什么模式？
4. **验证**：这些模式可靠吗？（统计推断）
5. **预测**：能预测吗？（预测模型）
6. **因果**：**X 真的导致 Y 吗？**（因果推断尝试）
7. **局限**：还有什么不确定的？
8. **建议**：基于证据的建议

**最终交付物**：

1. **完整分析报告** (`final_report.ipynb` 或 HTML)
   - 执行摘要（1页，强调因果发现）
   - 研究背景和问题（**包含因果问题**）
   - 数据介绍
   - 分析方法（描述 → 推断 → 预测 → **因果**）
   - 主要发现（**区分相关性和因果性**）
   - **因果图**（Pearl）
   - 局限性和未来方向

2. **数据集和代码**
   - 原始数据（或获取脚本）
   - 清洗后的数据
   - 完整代码（可复现）

3. **展示材料**
   - 10-15 分钟展示 PPT
   - 面向非技术观众
   - 突出**因果发现**和洞察

4. **AI 使用日志**
   - AI_LOG.md
   - 特别强调如何发现和修正 AI 的错误建议

---

## 评估标准

### 数据分析质量（35%）

| 维度 | 优秀 | 良好 | 合格 | 不合格 |
|------|------|------|------|--------|
| 问题定义 | 清晰、包含因果问题 | 较清晰 | 模糊但可执行 | 不明确 |
| 方法选择 | 恰当、前提验证 | 基本恰当 | 有小问题 | 明显错误 |
| **因果尝试** | 有因果图、方法合理 | 有尝试 | 浅尝 | 完全没有 |
| 结果解释 | 深入、区分相关/因果 | 较合理 | 表面化 | 混淆因果 |
| 可复现性 | 代码清晰、可运行 | 基本可复现 | 有小问题 | 无法复现 |

### 因果思维体现（20%）⭐ 重点项目特色

- 是否有因果图（Pearl）
- 是否识别了混杂变量
- 是否尝试因果推断方法
- 是否诚实讨论因果局限性

### AI 协作能力（15%）

- AI 使用是否透明（有日志）
- 是否能发现 AI 建议中的问题
- 是否能在 AI 基础上改进
- **是否识别了 AI 的因果推断错误**

### 数据沟通（20%）

- 可视化是否清晰、不误导
- 故事叙述是否有吸引力
- **因果解释是否易懂**
- 非技术观众能否理解

### 创新与洞察（10%）

- 是否有意外的发现
- 分析是否深入而非表面
- 是否提出了有价值的建议
- **因果发现是否有意义**

---

## 示例项目

### 示例 1：员工流失预测与因果分析
- **数据**：公司 HR 数据
- **问题**：
  - 预测：谁能预测员工会离职？
  - **因果**：**高工资真的能留住员工吗？**（还是有混杂变量？）
- **因果挑战**：工资和离职的关系可能有混杂（如职位级别）

### 示例 2：教育公平因果分析
- **数据**：学生成绩、家庭背景、学校资源
- **问题**：
  - **因果**：**学校资源能改善学生成绩吗？**还是只是相关？
  - 混杂：家庭收入既影响学校选择，又影响成绩
- **因果方法**：匹配或工具变量

### 示例 3：医疗干预效果评估
- **数据**：患者数据、治疗方案、康复结果
- **问题**：
  - **因果**：**新疗法真的比旧疗法好吗？**
  - 混杂：病情严重程度影响治疗方案选择
- **因果方法**：倾向得分匹配

---

## 与 Judea Pearl 的因果推断课程的联系

### 推荐阅读
- Pearl, J. & Mackenzie, D. (2018). *The Book of Why*.
- Pearl, J. (2009). *Causality*.

### 在线资源
- Pearl 的因果推断课程（UCLA）
- Causal Inference in Statistics（edX）

---

## 常见问题

**Q：没有实验数据，能做因果推断吗？**  
A：可以，但要诚实。观察数据的因果推断需要更强的假设。画出因果图，明确你在假设什么，讨论局限性。

**Q：因果推断太难了，能不做吗？**  
A：必须尝试。即使只是画因果图、识别混杂变量，也是重要的因果思维训练。不追求完美的因果结论，追求因果思维过程。

**Q：AI 能帮我做因果推断吗？**  
A：AI 可以生成代码，但**因果图必须由人来画**（基于领域知识）。AI 不知道你的业务场景中谁是混杂变量。

**Q：因果推断失败了怎么办？**  
A：这也是有价值的学习。讨论为什么失败（数据局限、无法识别混杂变量等），比强行得出因果结论更好。
